# 站点变化说明 #


---


  * 每个站的范围是从上一站和本站的**中点\*，到下一站和本站的**中点\*，在本站之前百分比会显示为负，本站之后会显示为正。
  * 所以按照这个逻辑，每次到了50%，就代表脱离了本站范围，到了下一站的范围，所以这时候百分比会由50%跳变为-50%。
  * 整个流程是：
    1. **南门总站**出发，百分比为0左右
    1. 随着校巴的运动，百分比会逐渐增大
    1. 到达\*南门总站**和**中山像站**中点时，百分比为50%
    1. 随后进入了**中山像站**的范围，百分比跳变为-50%
    1. 随着接近**中山像站**，百分比逐渐接近0；过了中山像站之后百分比变为正，并逐渐增大
    1. 到达\*中山像站**和**百步梯站**的中点时，百分比为50%
    1. 随后进入**百步梯站**的范围，所以百分比又跳变为-50%
    1. 依此类推……
    1. 到达\*北二总站**，百分比变为0左右，然后车往回跑。此时由于方向变了，百分比是从0开始逐渐**增加**的
    1. 到达\*北二总站**和**卫生所站**的中点时，百分比为50%
    1. 随后进入了**卫生所站**的范围，百分比跳变为-50%
    1. 依此类推……
    1. 到达\*南门总站**，百分比变为0左右
    1. 车停了，电源会关闭。几分钟以后服务器将Stop置为true，此时这辆校巴将不再显示**


---


写得都吐血了，要是还不明白……
```
direction = (shuttle.Direction) ? 1 : -1;
position = totalHeight(shuttle.StationIndex) + direction * shuttle.Percent * stationHeight(shuttle.StationIndex, direction);

function totalLength(index); // 返回这一站的圆点距起点的总长度
function stationLength(index, direction); // 返回这一站某侧线的长度，和行驶方向有关，因为有可能站点两边的线不同，所以传入direction参数。
```